"use strict";function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var s=Object.prototype.toString.call(e).slice(8,-1);return"Object"===s&&e.constructor&&(s=e.constructor.name),"Map"===s||"Set"===s?Array.from(e):"Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s)?_arrayLikeToArray(e,t):void 0}}function _iterableToArray(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var s=0,a=new Array(t);s<t;s++)a[s]=e[s];return a}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var s=0;s<t.length;s++){var a=t[s];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function _createClass(e,t,s){return t&&_defineProperties(e.prototype,t),s&&_defineProperties(e,s),e}var modal,success,Quiz=function(){function e(t){var s=t.slider,a=t.ableOnSelect,n=t.onSubmit,i=t.onChangeSlide;_classCallCheck(this,e),this.selector=".quiz",this.el=document.querySelector(this.selector),this.slider=s,this.pages=this.el.querySelectorAll(".quiz__page"),this.form=this.el.querySelector(".quiz__form"),this.inputs=this.el.querySelectorAll('label.quiz-item input[type="radio"], label.quiz-item input[type="checkbox"]'),this.pageAllowed=0,this.data={},this.pageCount=this.pages.length,this.ableOnSelect=a||!1,this.onSubmit=n,this.onChangeSlide=i,this.actions={prev:document.querySelector(".quiz-actions__prev"),next:document.querySelector(".quiz-actions__next")},this.progress={current:0,pageIdx:0,step:100/(this.pageCount-1),elem:document.querySelector(".progress-bar"),line:document.querySelector(".progress-bar .progress-bar__line"),lineCurrent:document.querySelector(".progress-bar .progress-bar__ready")},this.setup()}return _createClass(e,[{key:"progressUp",value:function(){this.progress.pageIdx++,this.progress.current+=this.progress.step;var e=Math.round(this.progress.current),t=e+"%",s=this.progress.lineCurrent;s.style.width=t,s.setAttribute("data-tooltip",t),s.classList.contains("start")&&s.classList.remove("start"),100===e&&s.classList.add("end")}},{key:"setupItems",value:function(){var e=this;this.inputs.forEach((function(t,s){t.addEventListener("change",(function(){var s=t.closest(".quiz__page"),a=s.hasAttribute("data-multiply"),n=s.querySelectorAll("label"),i=t.getAttribute("name"),r=t.getAttribute("value");a?(t.closest("label.quiz-item").classList.toggle("active"),t.checked?e.setData(i,r,a):e.setData(i,r,a,"delete")):(n.forEach((function(e){e.classList.remove("active")})),t.closest("label.quiz-item").classList.add("active"),e.setData(i,r)),e.pages.forEach((function(t,a){t===s&&e.pageAllowed<=a&&(e.pageAllowed++,e.enableNext())}))}))}))}},{key:"getHiddenInputs",value:function(){var e=[];for(var t in this.data){var s=document.createElement("input");s.setAttribute("type","hidden"),s.setAttribute("name",t);var a="string"==typeof this.data[t]?this.data[t]:Array.from(this.data[t]).join(", ");s.setAttribute("value",a),e.push(s)}return e}},{key:"finish",value:function(){var e,t=this.getHiddenInputs();(e=this.form).append.apply(e,_toConsumableArray(t))}},{key:"setData",value:function(e,t){var s=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"add";s?(this.data[e]||(this.data[e]=new Set),this.data[e][a](t)):this.data[e]=t}},{key:"disableNext",value:function(){this.actions.next.setAttribute("disabled","disabled")}},{key:"enableNext",value:function(){this.actions.next.removeAttribute("disabled")}},{key:"setup",value:function(){var e=this;e.actions.next.addEventListener("click",(function(t){e.slider.go("+"),e.pageAllowed===e.slider.index?e.disableNext():e.enableNext(),e.onChangeSlide()})),e.actions.prev.addEventListener("click",(function(t){e.slider.go("-"),e.enableNext(),e.onChangeSlide()})),e.slider.on("move",(function(t,s){t===e.slider.length-1&&(document.querySelector(".quiz-actions").style.display="none",e.finish()),t>e.progress.pageIdx&&e.progressUp()})),this.ableOnSelect&&this.disableNext(),this.setupItems()}}]),e}(),Modal=function(){function e(t){var s=t.selector,a=t.onFirstOpen;_classCallCheck(this,e),this.selector=s,this.el=document.querySelector(s),this.triggers=document.querySelectorAll('.call-modal[data-target="'+this.el.getAttribute("id")+'"]'),this.closeBtn=this.el.querySelector(".modal__close"),this.overlay=this.el.querySelector(".modal__overlay"),this.tooltips=this.el.querySelectorAll(".modal__tooltip-item"),this.opened=!1,this.onFirstOpen=a,this.setup()}return _createClass(e,[{key:"showModal",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];t?this.el.classList.add("active"):(this.el.classList.remove("hiding"),this.el.classList.add("active"),this.el.classList.add("showing"),setTimeout((function(){e.el.classList.remove("showing")}),250)),document.querySelector(".wrapper").classList.add("blured")}},{key:"hideModal",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];t?this.el.classList.remove("active"):(this.el.classList.remove("showing"),this.el.classList.add("hiding"),setTimeout((function(){e.el.classList.remove("active"),e.el.classList.remove("hiding")}),250)),document.querySelector(".wrapper").classList.remove("blured")}},{key:"showingHandler",value:function(){this.el.classList.contains("active")?this.hideModal():this.showModal()}},{key:"setTooltip",value:function(e){this.tooltips.forEach((function(e){e.classList.remove("active")})),this.tooltips[e].classList.add("active")}},{key:"setup",value:function(){var e=this;this.closeBtn.addEventListener("click",(function(t){e.hideModal()})),this.overlay.addEventListener("click",(function(t){t.target===e.overlay&&e.hideModal()})),this.triggers.forEach((function(t){t.addEventListener("click",(function(t){e.showingHandler(),e.opened||(e.onFirstOpen(),e.opened=!0)}))}))}}]),e}();function serialize(e){if(!e||"FORM"!==e.nodeName)return!1;var t,s,a=[];for(t=e.elements.length-1;t>=0;t-=1)if(""!==e.elements[t].name)switch(e.elements[t].nodeName){case"INPUT":switch(e.elements[t].type){case"text":case"tel":case"email":case"hidden":case"password":case"button":case"reset":case"submit":a.push(e.elements[t].name+"="+encodeURIComponent(e.elements[t].value));break;case"checkbox":writeCommaCheckbox(e,t,a);break;case"radio":e.elements[t].checked&&a.push(e.elements[t].name+"="+encodeURIComponent(e.elements[t].value))}break;case"file":break;case"TEXTAREA":a.push(e.elements[t].name+"="+encodeURIComponent(e.elements[t].value));break;case"SELECT":switch(e.elements[t].type){case"select-one":a.push(e.elements[t].name+"="+encodeURIComponent(e.elements[t].value));break;case"select-multiple":for(s=e.elements[t].options.length-1;s>=0;s-=1)e.elements[t].options[s].selected&&a.push(e.elements[t].name+"="+encodeURIComponent(e.elements[t].options[s].value))}break;case"BUTTON":switch(e.elements[t].type){case"reset":case"submit":case"button":a.push(e.elements[t].name+"="+encodeURIComponent(e.elements[t].value))}}return a.join("&")}function sendForm(e,t){if(t=t||function(){},event.preventDefault(),validateForm(e)){var s=new XMLHttpRequest,a=serialize(e);s.open("POST","./mail.php"),s.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),s.onreadystatechange=function(){4==s.readyState&&200==s.status&&(e.reset(),modal.hideModal(!0),success.showModal(!0),t())},s.send(a)}else alert("Заполните поля корректно")}function validateForm(e){var t=e.querySelector('input[name="tel"]'),s=e.querySelector('input[name="name"]');return!!t.value.match(/^((8|\+7)[\- ]?)?(\(?\d{3}\)?[\- ]?)?[\d\- ]{7,10}$/)&&s.value.length>=2}document.addEventListener("DOMContentLoaded",(function(){success=new Modal({selector:".modal--success"});var e=new Quiz({ableOnSelect:!0,onChangeSlide:function(){modal.setTooltip(e.slider.index)},slider:new Splide(".splide.quiz",{arrows:!1,perPage:1,perMove:1,pagination:!1,drag:!1,gap:120,padding:1})});modal=new Modal({selector:".modal--quiz",onFirstOpen:function(){e.slider.mount()}});var t=e.form.querySelector('input[type="tel"]'),s=IMask(t,{mask:"+{7}(000)000-00-00",lazy:!1});t.addEventListener("paste",(function(e){var t=e.clipboardData.getData("text");"8"==t.slice(0,1)&&(e.preventDefault(),t=t.slice(1),s.unmaskedValue=t)}))}));
//# sourceMappingURL=maps/main.min.js.map
