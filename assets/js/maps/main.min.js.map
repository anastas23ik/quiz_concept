{"version":3,"sources":["main.js"],"names":["modal","serialize","Quiz","_ref","slider","ableOnSelect","onSubmit","onChangeSlide","_classCallCheck","this","selector","el","document","querySelector","pages","querySelectorAll","form","inputs","pageAllowed","data","pageCount","length","actions","prev","next","progress","current","lineCurrent","setup","step","num","Math","output","contains","classList","remove","add","forEach","idx","multiply","page","hasAttribute","labels","key","getAttribute","value","closest","toggle","checked","_this","setData","label","pageIdx","p","i","round","enableNext","elems","createElement","elem","setAttribute","Array","from","join","push","addEventListener","_this$form","append","apply","_toConsumableArray","val","arguments","undefined","action","Set","removeAttribute","quiz","e","go","index","disableNext","style","progressUp","setupItems","Modal","_ref2","triggers","closeBtn","overlay","opened","onFirstOpen","_this2","disableAnimation","setTimeout","_this3","display","hideModal","tooltips","_this4","target","showingHandler","nodeName","j","name","elements","type","q","encodeURIComponent","writeCommaCheckbox","options","selected","sendForm","onSuccess","event","preventDefault","validateForm","xhr","body","onreadystatechange","readyState","status","reset","send","alert","inputTel","inputName","match","success","Splide","arrows","perPage","pagination","drag","gap","padding","mount","maskedElem","mask","lazy","clipboardData","getData","slice","unmaskedValue"],"mappings":"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","file":"../main.min.js","sourcesContent":["'use strict';\r\nclass Quiz {\r\n    constructor({slider, ableOnSelect, onSubmit, onChangeSlide}) {\r\n        this.selector = '.quiz';\r\n        this.el = document.querySelector(this.selector);\r\n        this.slider = slider;\r\n        this.pages = this.el.querySelectorAll('.quiz__page');\r\n        this.form = this.el.querySelector('.quiz__form');\r\n        // this.labels = this.el.querySelectorAll('label.quiz-item');\r\n        this.inputs = this.el.querySelectorAll('label.quiz-item input[type=\"radio\"], label.quiz-item input[type=\"checkbox\"]');\r\n        this.pageAllowed = 0;\r\n        this.data = {};\r\n        this.pageCount = this.pages.length;\r\n        this.ableOnSelect = ableOnSelect || false;\r\n        this.onSubmit = onSubmit;\r\n        this.onChangeSlide = onChangeSlide;\r\n        this.actions = {\r\n            prev: document.querySelector('.quiz-actions__prev'),\r\n            next: document.querySelector('.quiz-actions__next'),\r\n        };\r\n        this.progress = {\r\n            current: 0,\r\n            pageIdx: 0,\r\n            step: 100 / (this.pageCount - 1),\r\n            elem: document.querySelector('.progress-bar'),\r\n            line: document.querySelector('.progress-bar .progress-bar__line'),\r\n            lineCurrent: document.querySelector('.progress-bar .progress-bar__ready'),\r\n        };\r\n        this.setup();\r\n    }\r\n    progressUp() {\r\n        this.progress.pageIdx++;\r\n        this.progress.current += this.progress.step;\r\n        const num = Math.round(this.progress.current);\r\n        const output = num + '%';\r\n        const el = this.progress.lineCurrent;\r\n        el.style.width = output;\r\n        el.setAttribute('data-tooltip', output);\r\n        if (el.classList.contains('start')) {el.classList.remove('start');}\r\n        if (num === 100) {el.classList.add('end');}\r\n    }\r\n    setupItems() {\r\n        this.inputs.forEach((el, idx) => {\r\n            el.addEventListener('change', () => {\r\n                const page = el.closest('.quiz__page');\r\n                const multiply = page.hasAttribute('data-multiply');\r\n                const labels = page.querySelectorAll('label');\r\n                const key = el.getAttribute('name');\r\n                const value = el.getAttribute('value');\r\n                if (!multiply) {\r\n                    labels.forEach(label => {label.classList.remove('active')});\r\n                    el.closest('label.quiz-item').classList.add('active');\r\n                    this.setData(key, value);\r\n                } else {\r\n                    el.closest('label.quiz-item').classList.toggle('active');\r\n                    el.checked ?\r\n                        this.setData(key, value, multiply) :\r\n                        this.setData(key, value, multiply, 'delete');\r\n                }\r\n\r\n                this.pages.forEach((p, i) => {\r\n                    if (p === page && this.pageAllowed <= i) {\r\n                        this.pageAllowed++;\r\n                        this.enableNext();\r\n\r\n                    }\r\n                });\r\n            });\r\n        }); \r\n    }\r\n    getHiddenInputs() {\r\n        const elems = [];\r\n        for (let key in this.data) {\r\n            const elem = document.createElement('input');\r\n            elem.setAttribute('type', 'hidden');\r\n            elem.setAttribute('name', key);\r\n            const value = typeof this.data[key] === 'string' ?\r\n                this.data[key] :\r\n                Array.from(this.data[key]).join(', ');\r\n            elem.setAttribute('value', value);\r\n            elems.push(elem);\r\n        }\r\n        return elems;\r\n    }\r\n    finish() {\r\n        const inputs = this.getHiddenInputs();\r\n        this.form.append(...inputs);\r\n    }\r\n    setData(key, val, multiply = false, action = 'add') {\r\n        if (!multiply) {\r\n            this.data[key] = val;\r\n        } else {\r\n            if (!this.data[key]) {\r\n                this.data[key] = new Set();\r\n            }\r\n            this.data[key][action](val);\r\n        }\r\n    }\r\n    disableNext() {\r\n        this.actions.next.setAttribute('disabled', 'disabled');\r\n    }\r\n    enableNext() {\r\n        this.actions.next.removeAttribute('disabled');\r\n    }\r\n    setup() {\r\n        const quiz = this;\r\n        quiz.actions.next.addEventListener('click', function(e) {\r\n            quiz.slider.go( '+' );\r\n            quiz.pageAllowed === quiz.slider.index ?\r\n                quiz.disableNext() :\r\n                quiz.enableNext();\r\n            quiz.onChangeSlide();\r\n        });\r\n        quiz.actions.prev.addEventListener('click', function(e) {\r\n            quiz.slider.go( '-' );\r\n            quiz.enableNext();\r\n            quiz.onChangeSlide();\r\n        });\r\n        quiz.slider.on('move', function(next, prev) {\r\n            if (next === quiz.slider.length - 1) {\r\n                document.querySelector('.quiz-actions').style.display = 'none';\r\n                quiz.finish();\r\n            }\r\n            if (next > quiz.progress.pageIdx) {\r\n                quiz.progressUp();\r\n            }\r\n        });\r\n\r\n        if (this.ableOnSelect) {\r\n            this.disableNext();\r\n        }\r\n        this.setupItems();\r\n\r\n        // this.form.addEventListener('submit', (e) => {\r\n        //     if (this.onSubmit) {\r\n        //         e.preventDefault();\r\n        //         this.onSubmit();\r\n        //     }\r\n        // });\r\n    }\r\n}\r\n\r\nclass Modal {\r\n    constructor({selector, onFirstOpen}) {\r\n        this.selector = selector;\r\n        this.el = document.querySelector(selector);\r\n        this.triggers = document.querySelectorAll('.call-modal[data-target=\"' + this.el.getAttribute('id') + '\"]');\r\n        this.closeBtn = this.el.querySelector('.modal__close');\r\n        this.overlay = this.el.querySelector('.modal__overlay');\r\n        this.tooltips = this.el.querySelectorAll('.modal__tooltip-item');\r\n        this.opened = false;\r\n        this.onFirstOpen = onFirstOpen;\r\n        this.setup();\r\n    }\r\n    showModal(disableAnimation = false) {\r\n        if (disableAnimation) {\r\n            this.el.classList.add('active');\r\n        } else {\r\n            this.el.classList.remove('hiding');\r\n            this.el.classList.add('active');\r\n            this.el.classList.add('showing');\r\n            setTimeout(() => {\r\n                this.el.classList.remove('showing');\r\n            }, 250);\r\n        }\r\n        document.querySelector('.wrapper').classList.add('blured');\r\n    }\r\n    hideModal(disableAnimation = false) {\r\n        if (disableAnimation) {\r\n            this.el.classList.remove('active');\r\n        } else {\r\n            this.el.classList.remove('showing');\r\n            this.el.classList.add('hiding');\r\n            setTimeout(() => {\r\n                this.el.classList.remove('active');\r\n                this.el.classList.remove('hiding');\r\n            }, 250);\r\n        }\r\n        document.querySelector('.wrapper').classList.remove('blured');\r\n    }\r\n    showingHandler() {\r\n        this.el.classList.contains('active') ?\r\n            this.hideModal() :\r\n            this.showModal();\r\n    }\r\n    setTooltip(idx) {\r\n        this.tooltips.forEach(el => {\r\n            el.classList.remove('active');\r\n        });\r\n        this.tooltips[idx].classList.add('active');\r\n    }\r\n    setup() {\r\n        this.closeBtn.addEventListener('click', (e) => {\r\n            this.hideModal();\r\n        });\r\n        this.overlay.addEventListener('click', (e) => {\r\n            if (e.target === this.overlay) {\r\n                this.hideModal();\r\n            }\r\n        })\r\n        this.triggers.forEach((el) => {\r\n            el.addEventListener('click', (e) => {\r\n                this.showingHandler();\r\n                if (!this.opened) {\r\n                    this.onFirstOpen();\r\n                    this.opened = true;\r\n                }\r\n            });\r\n        });\r\n    }\r\n}\r\n\r\nfunction serialize(form) {\r\n\tif (!form || form.nodeName !== \"FORM\") {\r\n\t\treturn false;\r\n\t}\r\n\tvar i, j, q = [];\r\n\tfor (i = form.elements.length - 1; i >= 0; i = i - 1) {\r\n\t\tif (form.elements[i].name === \"\") {\r\n\t\t\tcontinue;\r\n\t\t}\r\n\t\tswitch (form.elements[i].nodeName) {\r\n\t\t\tcase 'INPUT':\r\n\t\t\t\tswitch (form.elements[i].type) {\r\n\t\t\t\t\tcase 'text':\r\n\t\t\t\t\tcase 'tel':\r\n\t\t\t\t\tcase 'email':\r\n\t\t\t\t\tcase 'hidden':\r\n\t\t\t\t\tcase 'password':\r\n\t\t\t\t\tcase 'button':\r\n\t\t\t\t\tcase 'reset':\r\n\t\t\t\t\tcase 'submit':\r\n\t\t\t\t\t\tq.push(form.elements[i].name + \"=\" + encodeURIComponent(form.elements[i].value));\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'checkbox':\r\n\t\t\t\t\t\twriteCommaCheckbox(form, i, q);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'radio':\r\n\t\t\t\t\t\tif (form.elements[i].checked) {\r\n\t\t\t\t\t\t\tq.push(form.elements[i].name + \"=\" + encodeURIComponent(form.elements[i].value));\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'file':\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'TEXTAREA':\r\n\t\t\t\tq.push(form.elements[i].name + \"=\" + encodeURIComponent(form.elements[i].value));\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'SELECT':\r\n\t\t\t\tswitch (form.elements[i].type) {\r\n\t\t\t\t\tcase 'select-one':\r\n\t\t\t\t\t\tq.push(form.elements[i].name + \"=\" + encodeURIComponent(form.elements[i].value));\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'select-multiple':\r\n\t\t\t\t\t\tfor (j = form.elements[i].options.length - 1; j >= 0; j = j - 1) {\r\n\t\t\t\t\t\t\tif (form.elements[i].options[j].selected) {\r\n\t\t\t\t\t\t\t\tq.push(form.elements[i].name + \"=\" + encodeURIComponent(form.elements[i].options[j].value));\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'BUTTON':\r\n\t\t\t\tswitch (form.elements[i].type) {\r\n\t\t\t\t\tcase 'reset':\r\n\t\t\t\t\tcase 'submit':\r\n\t\t\t\t\tcase 'button':\r\n\t\t\t\t\t\tq.push(form.elements[i].name + \"=\" + encodeURIComponent(form.elements[i].value));\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n\treturn q.join(\"&\");\r\n}\r\n\r\nfunction sendForm(form, onSuccess) {\r\n    onSuccess = onSuccess || function(){};\r\n    event.preventDefault();\r\n    if (validateForm(form)) {\r\n        var xhr = new XMLHttpRequest();\r\n        var body = serialize(form);\r\n        xhr.open('POST', './mail.php');\r\n        xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');\r\n        xhr.onreadystatechange = function() {\r\n            if (xhr.readyState == 4 && xhr.status == 200) {\r\n                form.reset();\r\n                modal.hideModal(true);\r\n                success.showModal(true);\r\n                onSuccess();\r\n            }\r\n        };\r\n        xhr.send(body);\r\n    } else {\r\n        alert('Заполните поля корректно');\r\n    }\r\n}\r\nfunction validateForm(form) {\r\n\tvar regTel = /^((8|\\+7)[\\- ]?)?(\\(?\\d{3}\\)?[\\- ]?)?[\\d\\- ]{7,10}$/;\r\n\tvar inputTel = form.querySelector('input[name=\"tel\"]');\r\n    var inputName = form.querySelector('input[name=\"name\"]');\r\n    return (!!inputTel.value.match(regTel) && inputName.value.length >= 2);\r\n}\r\n\r\nvar modal, success;\r\ndocument.addEventListener('DOMContentLoaded', function() {\r\n    success = new Modal({\r\n        selector: '.modal--success'\r\n    });\r\n\r\n    const quiz = new Quiz({\r\n        ableOnSelect: true,\r\n        onChangeSlide() {\r\n            modal.setTooltip(quiz.slider.index);\r\n        },\r\n        slider: new Splide('.splide.quiz', {\r\n            arrows: false,\r\n            perPage: 1,\r\n            perMove: 1,\r\n            pagination: false,\r\n            drag: false,\r\n            gap: 120,\r\n            padding: 1,\r\n        })\r\n    });\r\n    modal = new Modal({\r\n        selector: '.modal--quiz',\r\n        onFirstOpen() {\r\n            quiz.slider.mount();\r\n        }\r\n    });\r\n\r\n    const maskedElem = quiz.form.querySelector('input[type=\"tel\"]');\r\n\r\n    const maskOptions = {\r\n        mask: '+{7}(000)000-00-00',\r\n        lazy: false\r\n    };\r\n    const mask = IMask(maskedElem, maskOptions);\r\n\r\n    maskedElem.addEventListener('paste', e => {\r\n        let data = e.clipboardData.getData('text');\r\n        if (data.slice(0, 1) == '8') {\r\n            e.preventDefault();\r\n            data = data.slice(1);\r\n            mask.unmaskedValue = data;\r\n        }\r\n    });\r\n});"]}